# 数据包隧道提供商

> 实现一个面向数据包的自定义 VPN 协议的 VPN 客户端。

## 概述

虚拟专用网络(VPN)是一种网络隧道形式,VPN 客户端使用公共互联网创建到 VPN 服务器的连接,然后通过该连接传输私有网络流量。如果您想构建实现数据包导向的自定义 VPN 协议的 VPN 客户端,请创建一个数据包隧道提供程序应用程序扩展。
当系统启动使用您的数据包隧道提供商的 VPN 配置时，它会执行以下步骤: 1. 创建一个新的网络接口,用于 VPN 连接。 2. 配置新接口的 IP 地址和路由表。 3. 启动数据包隧道提供商的客户端软件。 4. 建立与 VPN 服务器的安全连接。 5. 将所有网络流量通过 VPN 隧道路由

## 启动您的应用程序扩展

在该应用程序扩展中实例化您的数据包隧道提供程序子类。
开始转发数据包到您的提供商。
您的提供商应该打开一个通往 VPN 服务器的隧道,并通过该隧道发送这些数据包。同样,如果您的提供商从隧道接收到数据包,它应该将它们传回到系统中。
数据包隧道提供商可以在目标 IP 模式或源应用程序模式下运行。后者是每应用程序 VPN 的一种形式(另一种形式是应用程序代理提供商 )。
有关数据包隧道提供商部署选项的详细信息,请参见 TN3134:网络扩展提供商部署 。

::: tip Note
当 VPN 配置处于活动状态时,连接将使用 VPN 而不是 iCloud 私人中继。网络扩展提供商也不会使用 iCloud 私人中继。
:::
